<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="fs.human.ecospot.location.dao.AccomDAO">

    <!-- 숙소 추가 -->
    <insert id="insertAccommodation" parameterType="fs.human.ecospot.location.vo.AccomVO">
        INSERT INTO TB_ACCOMMODATION (
            ACCOM_ID, ACCOM_NAME, ACCOM_DESC, ACCOM_CHECKIN, ACCOM_CHECKOUT,
            ACCOM_ADDRESS, ACCOM_ADDRESS_D, ACCOM_LAT, ACCOM_LON, 
            ACCOM_PHONE, ACCOM_URL, ACCOM_IMG_MAIN1,
            CREATED_ID, CREATED_DATE
        ) VALUES (
            (SELECT NVL(MAX(ACCOM_ID), 0) + 1 FROM TB_ACCOMMODATION), 
            #{accomName}, #{accomDesc}, #{accomCheckin}, #{accomCheckout},
            #{accomAddress}, #{accomAddressD}, #{accomLat}, #{accomLon},
            #{accomPhone}, #{accomUrl}, #{accomImgMain},
            #{createdId}, SYSDATE
        )
    </insert>

    <!-- 모든 숙소 목록 조회 -->
    <select id="selectAllAccommodations" resultType="fs.human.ecospot.location.vo.AccomVO">
        SELECT 
            ACCOM_ID as accomId,
            ACCOM_NAME as accomName,
            ACCOM_DESC as accomDesc,
            ACCOM_CHECKIN as accomCheckin,
            ACCOM_CHECKOUT as accomCheckout,
            ACCOM_ADDRESS as accomAddress,
            ACCOM_ADDRESS_D as accomAddressD,
            ACCOM_LAT as accomLat,
            ACCOM_LON as accomLon,
            ACCOM_PHONE as accomPhone,
            ACCOM_URL as accomUrl,
            ACCOM_IMG_MAIN1 as accomImgMain,
            CREATED_ID as createdId,
            TO_CHAR(CREATED_DATE, 'YYYY-MM-DD') as createdDate,
            UPDATED_ID as updatedId,
            TO_CHAR(UPDATED_DATE, 'YYYY-MM-DD') as updatedDate
        FROM TB_ACCOMMODATION
        ORDER BY CREATED_DATE DESC
    </select>

    <!-- 숙소 ID로 조회 -->
    <select id="selectAccommodationById" parameterType="long" resultType="fs.human.ecospot.location.vo.AccomVO">
        SELECT 
            ACCOM_ID as accomId,
            ACCOM_NAME as accomName,
            ACCOM_DESC as accomDesc,
            ACCOM_CHECKIN as accomCheckin,
            ACCOM_CHECKOUT as accomCheckout,
            ACCOM_ADDRESS as accomAddress,
            ACCOM_ADDRESS_D as accomAddressD,
            ACCOM_LAT as accomLat,
            ACCOM_LON as accomLon,
            ACCOM_PHONE as accomPhone,
            ACCOM_URL as accomUrl,
            ACCOM_IMG_MAIN1 as accomImgMain,
            CREATED_ID as createdId,
            TO_CHAR(CREATED_DATE, 'YYYY-MM-DD') as createdDate,
            UPDATED_ID as updatedId,
            TO_CHAR(UPDATED_DATE, 'YYYY-MM-DD') as updatedDate
        FROM TB_ACCOMMODATION
        WHERE ACCOM_ID = #{accomId}
    </select>

    <!-- 숙소 수정 -->
    <update id="updateAccommodation" parameterType="fs.human.ecospot.location.vo.AccomVO">
        UPDATE TB_ACCOMMODATION
        SET 
            ACCOM_NAME = #{accomName},
            ACCOM_DESC = #{accomDesc},
            ACCOM_CHECKIN = #{accomCheckin},
            ACCOM_CHECKOUT = #{accomCheckout},
            ACCOM_ADDRESS = #{accomAddress},
            ACCOM_ADDRESS_D = #{accomAddressD},
            ACCOM_LAT = #{accomLat},
            ACCOM_LON = #{accomLon},
            ACCOM_PHONE = #{accomPhone},
            ACCOM_URL = #{accomUrl},
            ACCOM_IMG_MAIN1 = #{accomImgMain},
            UPDATED_ID = #{updatedId},
            UPDATED_DATE = SYSDATE
        WHERE ACCOM_ID = #{accomId}
    </update>

    <!-- 숙소 삭제 -->
    <delete id="deleteAccommodation" parameterType="long">
        DELETE FROM TB_ACCOMMODATION
        WHERE ACCOM_ID = #{accomId}
    </delete>

</mapper>